{"remainingRequest":"/Users/marquisdong/Desktop/认证证书/test_websocket/ChattingRoom/ChattingRoom/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/marquisdong/Desktop/认证证书/test_websocket/ChattingRoom/ChattingRoom/client/src/components/ChatRoom.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/marquisdong/Desktop/认证证书/test_websocket/ChattingRoom/ChattingRoom/client/src/components/ChatRoom.vue","mtime":1640507031582},{"path":"/Users/marquisdong/Desktop/认证证书/test_websocket/ChattingRoom/ChattingRoom/client/node_modules/cache-loader/dist/cjs.js","mtime":1640492345169},{"path":"/Users/marquisdong/Desktop/认证证书/test_websocket/ChattingRoom/ChattingRoom/client/node_modules/babel-loader/lib/index.js","mtime":1640492345876},{"path":"/Users/marquisdong/Desktop/认证证书/test_websocket/ChattingRoom/ChattingRoom/client/node_modules/cache-loader/dist/cjs.js","mtime":1640492345169},{"path":"/Users/marquisdong/Desktop/认证证书/test_websocket/ChattingRoom/ChattingRoom/client/node_modules/vue-loader/lib/index.js","mtime":1640492340427}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7Tm90aWZpY2F0aW9ufSBmcm9tICdlbGVtZW50LXVpJzsKbGV0IGJhc2VfdXJsID0gJ3dzOi8vMTI3LjAuMC4xOjgwODEvd3MnOwoKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogJ0NoYXRSb29tJywKICAgIGRhdGEoKXsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBuaWNrbmFtZTogJycsCiAgICAgICAgICAgIG1lc3NhZ2U6ICcnLAogICAgICAgICAgICBtZXNzYWdlczogJycsCiAgICAgICAgICAgIHNvY2tldDogbnVsbCwKICAgICAgICB9CiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIHNlbmQoKSB7CiAgICAgICAgICAgIGxldCBpbmZvID0gdGhpcy5uaWNrbmFtZSArICfvvJonICsgdGhpcy5tZXNzYWdlICsgJ1xuJzsKICAgICAgICAgICAgbGV0IGRhdGEgPSB7CiAgICAgICAgICAgICAgICB1c2VyOiB0aGlzLm5pY2tuYW1lLAogICAgICAgICAgICAgICAgbWVzc2FnZTogdGhpcy5tZXNzYWdlCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHRoaXMuc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOwogICAgICAgICAgICB0aGlzLm1lc3NhZ2VzICs9IGluZm87CiAgICAgICAgICAgIHRoaXMubWVzc2FnZSA9ICcnOwogICAgICAgIH0sCiAgICAgICAgam9pbigpIHsKICAgICAgICAgICAgdGhpcy4kcHJvbXB0KCfor7fovpPlhaXmmLXnp7AnLCAn5o+Q56S6JywgewogICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgICAgICAgICAgaW5wdXRQbGFjZWhvbGRlcjogJ+ivt+i+k+WFpeaYteensCcsCiAgICAgICAgICAgICAgICBpbnB1dEVycm9yTWVzc2FnZTogJ+aYteensOS4jeiDveS4uuepuicsCiAgICAgICAgICAgICAgICBpbnB1dFZhbGlkYXRvcjogZnVuY3Rpb24gKCRldmVudCkgewogICAgICAgICAgICAgICAgcmV0dXJuICRldmVudC5sZW5ndGggPiAwCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLnRoZW4oKHsgdmFsdWUgfSkgPT4gewogICAgICAgICAgICAgICAgdGhpcy5uaWNrbmFtZSA9IHZhbHVlOwogICAgICAgICAgICAvLyAgICDlj5Hotbcgd2Vic29ja2V0IOi/nuaOpQogICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVXZWJTb2NrZXQoKTsKICAgICAgICAgICAgfSkuY2F0Y2goKCkgPT4gewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+WPlua2iOi+k+WFpScpCiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBkaXNjb25uZWN0KCkgewogICAgICAgICAgICBpZiAodGhpcy5zb2NrZXQgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnNvY2tldCAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgdGhpcy5zb2NrZXQuY2xvc2UoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnNvY2tldCA9IG51bGw7CiAgICAgICAgICAgIHRoaXMubmlja25hbWUgPSAnJzsKICAgICAgICB9LAogICAgICAgIGxlYXZpbmcoJGV2ZW50KSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCRldmVudCk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuc29ja2V0KTsKICAgICAgICAgICAgaWYgKHRoaXMuc29ja2V0ICE9PSB1bmRlZmluZWQgJiYgdGhpcy5zb2NrZXQgIT09IG51bGwpIHsKICAgICAgICAgICAgICAgIHRoaXMuc29ja2V0LmNsb3NlKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGNyZWF0ZVdlYlNvY2tldCgpIHsKICAgICAgICAgICAgaWYgKHRoaXMuc29ja2V0ID09PSBudWxsKSB7CiAgICAgICAgICAgICAgICB0aGlzLnNvY2tldCA9IG5ldyBXZWJTb2NrZXQoYmFzZV91cmwpCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMuc29ja2V0Lm9ub3BlbiA9IChldmVudCkgPT4gewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXZlbnQpOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Nvbm5lY3RlZCcpOwogICAgICAgICAgICAgICAgTm90aWZpY2F0aW9uLnN1Y2Nlc3MoJ+i/nuaOpeW3suW7uueriycpOwogICAgICAgICAgICAvLyAgICDliJ3mrKHlu7rnq4vov57mjqXvvIzlj5HpgIHmmLXnp7AKICAgICAgICAgICAgICAgIGxldCBkYXRhID0ge3VzZXI6IHRoaXMubmlja25hbWV9OwogICAgICAgICAgICAgICAgdGhpcy5zb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeShkYXRhKSk7CiAgICAgICAgICAgIH07CgogICAgICAgICAgICB0aGlzLnNvY2tldC5vbm1lc3NhZ2UgPSAoZXZlbnQpID0+IHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGV2ZW50KTsKICAgICAgICAgICAgICAgIGxldCBkYXRhID0gSlNPTi5wYXJzZShldmVudC5kYXRhKQogICAgICAgICAgICAgICAgbGV0IGluZm8gPSBkYXRhLnVzZXIgKyAn77yaJyArIGRhdGEubWVzc2FnZSArICdcbic7CiAgICAgICAgICAgICAgICBOb3RpZmljYXRpb24uaW5mbyhpbmZvKTsKICAgICAgICAgICAgICAgIC8vICAgIOa2iOaBr+WGheWuueWkhOeQhgogICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlcyArPSBpbmZvCiAgICAgICAgICAgIH07CgogICAgICAgICAgICB0aGlzLnNvY2tldC5vbmVycm9yID0gKGV2ZW50KSA9PiB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhldmVudCk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyb3InKTsKICAgICAgICAgICAgICAgIE5vdGlmaWNhdGlvbi5lcnJvcign5pyN5Yqh56uv6L+Q6KGM5Y+R55Sf5byC5bi4Jyk7CiAgICAgICAgICAgIH07CgogICAgICAgICAgICB0aGlzLnNvY2tldC5vbmNsb3NlID0gKGV2ZW50KSA9PiB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhldmVudCk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY2xvc2UnKTsKICAgICAgICAgICAgICAgIE5vdGlmaWNhdGlvbi5pbmZvKCfmnI3liqHnq6/lhbPpl63ov57mjqUnKTsKICAgICAgICAgICAgICAgIHRoaXMubmlja25hbWUgPSAnJzsKICAgICAgICAgICAgICAgIHRoaXMuc29ja2V0ID0gbnVsbDsKICAgICAgICAgICAgfTsKICAgICAgICB9LAogICAgfSwKICAgIGNyZWF0ZWQoKSB7CiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIHRoaXMubGVhdmluZyk7CiAgICB9Cn0K"},{"version":3,"sources":["ChatRoom.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkCA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ChatRoom.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <el-container style=\"height: 100%;\">\n        <el-header height=\"120px\" style=\"background-color: peachpuff; display: grid\">\n            <el-row :gutter=\"20\" type=\"flex\" justify=\"space-around\" align=\"middle\">\n                <el-col :span=\"6\" :offset=\"0\" style=\"font-size: xx-large;\">Chatting Room</el-col>\n                <el-col :span=\"6\" :offset=\"12\" style=\"font-size: xx-large\">Nickname：{{ nickname }}</el-col>\n            </el-row>\n        </el-header>\n        <el-main style=\"border: 1px; border-radius: 2px;\">\n            <el-input\n                    type=\"textarea\"\n                    readonly\n                    v-model=\"messages\"\n                    style=\"height: 100%;\"\n            ></el-input>\n        </el-main>\n        <el-footer height=\"240px\" style=\"border: 1px; border-radius: 4px; box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1); padding: 5px;\">\n            <el-input\n                    type=\"textarea\"\n                    :rows=\"5\"\n                    placeholder=\"请输入消息内容(Please input some message)\"\n                    v-model=\"message\"\n                    style=\"border-radius: 2px;\"\n            ></el-input>\n            <el-row :gutter=\"20\" type=\"flex\" justify=\"end\" align=\"middle\" style=\"padding: 10px;\">\n                <el-button type=\"primary\" size=\"medium\" @click=\"send()\" v-if=\"nickname !== ''\">发送/Send</el-button>\n                <el-button type=\"primary\" size=\"medium\" @click=\"disconnect()\" v-if=\"nickname !== ''\">退出聊天/Quit Chat</el-button>\n                <el-button type=\"primary\" size=\"medium\" @click=\"join()\" v-if=\"nickname === ''\">加入聊天/Join Chat</el-button>\n            </el-row>\n        </el-footer>\n    </el-container>\n</template>\n\n<script>\n    import {Notification} from 'element-ui';\n    let base_url = 'ws://127.0.0.1:8081/ws';\n\n    export default {\n        name: 'ChatRoom',\n        data(){\n            return {\n                nickname: '',\n                message: '',\n                messages: '',\n                socket: null,\n            }\n        },\n        methods: {\n            send() {\n                let info = this.nickname + '：' + this.message + '\\n';\n                let data = {\n                    user: this.nickname,\n                    message: this.message\n                };\n                this.socket.send(JSON.stringify(data));\n                this.messages += info;\n                this.message = '';\n            },\n            join() {\n                this.$prompt('请输入昵称', '提示', {\n                    confirmButtonText: '确定',\n                    inputPlaceholder: '请输入昵称',\n                    inputErrorMessage: '昵称不能为空',\n                    inputValidator: function ($event) {\n                    return $event.length > 0\n                    }\n                }).then(({ value }) => {\n                    this.nickname = value;\n                //    发起 websocket 连接\n                    this.createWebSocket();\n                }).catch(() => {\n                    console.log('取消输入')\n                })\n            },\n            disconnect() {\n                if (this.socket !== undefined && this.socket !== null) {\n                    this.socket.close();\n                }\n                this.socket = null;\n                this.nickname = '';\n            },\n            leaving($event) {\n                console.log($event);\n                console.log(this.socket);\n                if (this.socket !== undefined && this.socket !== null) {\n                    this.socket.close();\n                }\n            },\n            createWebSocket() {\n                if (this.socket === null) {\n                    this.socket = new WebSocket(base_url)\n                }\n\n                this.socket.onopen = (event) => {\n                    console.log(event);\n                    console.log('connected');\n                    Notification.success('连接已建立');\n                //    初次建立连接，发送昵称\n                    let data = {user: this.nickname};\n                    this.socket.send(JSON.stringify(data));\n                };\n\n                this.socket.onmessage = (event) => {\n                    console.log(event);\n                    let data = JSON.parse(event.data)\n                    let info = data.user + '：' + data.message + '\\n';\n                    Notification.info(info);\n                    //    消息内容处理\n                    this.messages += info\n                };\n\n                this.socket.onerror = (event) => {\n                    console.log(event);\n                    console.log('error');\n                    Notification.error('服务端运行发生异常');\n                };\n\n                this.socket.onclose = (event) => {\n                    console.log(event);\n                    console.log('close');\n                    Notification.info('服务端关闭连接');\n                    this.nickname = '';\n                    this.socket = null;\n                };\n            },\n        },\n        created() {\n            window.addEventListener('beforeunload', this.leaving);\n        }\n    }\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\n>>> .el-textarea__inner {\n        height: 100%;\n    }\n</style>\n"]}]}